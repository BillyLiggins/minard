{% extends "layout.html" %}
{% block title %}Channels{% endblock %}
{% block head %}
{{ super() }}

<div class="container">
<h2>Run {{ run_number }} details</h2>            
<div class="row">        
    <div class="panel panel-default">
        <div class="panel-heading">
            <h3 class="panel-title">QHS / QHS average</h3>
        </div>
        <div class="panel-body">
            <img src="/data/snoplus/shared/data/eca/gen/{{ run_number }}fPedestal2.png" 
            alt="QHS histogram" class="img-responsive col-md-6">
            <img src="/data/snoplus/shared/data/eca/gen/{{ run_number }}fPedAve2.png" 
            alt="QHS average by crate(?)" class="img-responsive col-md-6">          
        </div>
    </div>
</div>

<div class="row">        
    <div class="panel panel-default">
        <div class="panel-heading">
            <h3 class="panel-title">QHL / QHL average</h3>
        </div>
        <div class="panel-body">
            <img src="/data/snoplus/shared/data/eca/gen/{{ run_number }}fPedestal2.png" 
            alt="QHL histogram" class="img-responsive col-md-6">
            <img src="/data/snoplus/shared/data/eca/gen/{{ run_number }}fPedAve2.png" 
            alt="QHL average by crate(?)" class="img-responsive col-md-6">          
        </div>
    </div>
</div>


<div class="row">        
    <div class="panel panel-default">
        <div class="panel-heading">
            <h3 class="panel-title">QLX / QLX average</h3>
        </div>
        <div class="panel-body">
            <img src="/data/snoplus/shared/data/eca/gen/{{ run_number }}fPedestal3.png" 
            alt="QLX histogram" class="img-responsive col-md-6">
            <img src="/data/snoplus/shared/data/eca/gen/{{ run_number }}fPedAve3.png" 
            alt="QLX average by crate(?)" class="img-responsive col-md-6">          
        </div>
    </div>
</div>


<div class="row">        
    <div class="panel panel-default">
        <div class="panel-heading">
            <h3 class="panel-title">TAC / TAC average</h3>
        </div>
        <div class="panel-body">
            <img src="/data/snoplus/shared/data/eca/gen/{{ run_number }}fPedestal4.png" 
            alt="TAC histogram" class="img-responsive col-md-6">
            <img src="/data/snoplus/shared/data/eca/gen/{{ run_number }}fPedAve4.png" 
            alt="TAC average by crate(?)" class="img-responsive col-md-6">          
        </div>
    </div>
</div>

<div class="row">        
    <div class="panel panel-default">
        <div class="panel-heading">
            <h3 class="panel-title">QHS Width / QHS Width average</h3>
        </div>
        <div class="panel-body">
            <img src="/data/snoplus/shared/data/eca/gen/{{ run_number }}fPWidth1.png" 
            alt="QHS Width histogram" class="img-responsive col-md-6">
            <img src="/data/snoplus/shared/data/eca/gen/{{ run_number }}fWidthAve1.png" 
            alt="QHS Width average by crate(?)" class="img-responsive col-md-6">          
        </div>
    </div>
</div>

<div class="row">        
    <div class="panel panel-default">
        <div class="panel-heading">
            <h3 class="panel-title">QHL Width / QHL Width average</h3>
        </div>
        <div class="panel-body">
            <img src="/data/snoplus/shared/data/eca/gen/{{ run_number }}fPWidth2.png" 
            alt="QHL Width histogram" class="img-responsive col-md-6">
            <img src="/data/snoplus/shared/data/eca/gen/{{ run_number }}fWidthAve2.png" 
            alt="QHL Width average by crate(?)" class="img-responsive col-md-6">          
        </div>
    </div>
</div>


<div class="row">        
    <div class="panel panel-default">
        <div class="panel-heading">
            <h3 class="panel-title">QLX Width / QLX Width average</h3>
        </div>
        <div class="panel-body">
            <img src="/data/snoplus/shared/data/eca/gen/{{ run_number }}fPWidth3.png" 
            alt="QLX Width histogram" class="img-responsive col-md-6">
            <img src="/data/snoplus/shared/data/eca/gen/{{ run_number }}fWidthAve3.png" 
            alt="QLX Width average by crate(?)" class="img-responsive col-md-6">          
        </div>
    </div>
</div>


<div class="row">        
    <div class="panel panel-default">
        <div class="panel-heading">
            <h3 class="panel-title">TAC Width / TAC Width average</h3>
        </div>
        <div class="panel-body">
            <img src="/data/snoplus/shared/data/eca/gen/{{ run_number }}fPWidth4.png" 
            alt="TAC Width histogram" class="img-responsive col-md-6">
            <img src="/data/snoplus/shared/data/eca/gen/{{ run_number }}fWidthAve4.png" 
            alt="TAC Width average by crate(?)" class="img-responsive col-md-6">          
        </div>
    </div>
</div>


<style>
    #card table tr td {
        font-size: 10px;
        text-align: right;
        width: 25px;
        height: 18px;
    }

    #crate table tr td {
        padding:2px;
    }

    .card-label-row {
      padding-right: 5px;
    }

    .card-label-col {
      text-align:center !important;
    }
</style>
<meta charset="UTF-8">
<script src="{{ url_for('static', filename='js/d3.js') }}"></script>
<script src="{{ url_for('static', filename='js/bar-chart.js') }}"></script>
<script src="{{ url_for('static', filename='js/crate.js') }}"></script>
{% endblock %}
{% block body %}
{{ super() }}
<div class="container">
    <div class="row">
        <div class="col-md-12" id="crate">
            <h4>Crate View - Run {{ run_number }}</h4>
        </div>
    </div>
</div>
<script>
    $SCRIPT_ROOT = {{ request.script_root|tojson|safe }};


    var crate = crate_view().scale(function() {return "#ff0";});
    crate.click(function(d, i) {
        card.crate(i);
        d3.select('#card').call(card);
        $('#card h4 small').text('Crate ' + i);
    });



    function update() {
        $.getJSON($SCRIPT_ROOT + '/query', {name: '{{ name }}', stats: $('#stats').val()})
            .done(function(result) {
                d3.select('#crate').datum(result.value).call(crate);
                d3.select('#card').datum(result.value).call(card);
                success()
            });
    }

    d3.select('#crate').datum([]).call(crate);
    $("#crate9").after("<br>");
    update();

</script>
<script>$('#nav-{{ name }}').attr('class','active');</script>
{% endblock %}
