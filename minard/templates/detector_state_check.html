{% extends "layout.html" %}
{% block title %}Detector State Check{% endblock %}
{% block head %}
    {{ super() }}
{% endblock %}
{% block body %}
    {{ super() }}
    <div class="container">
        {% if error %}
        <div class="alert alert-danger" role="alert">
            <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
            {{ error }}
        </div>
        {% endif %}
        <div class="row">
            <div class="col-md-12">
                <center>
                    {% if run == 0 %}
                        <h1>Current State</h1>
                    {% else %}
                        <h1>Run {{ run }}</h2>
                    {% endif %}
                </center>
            </div>
            <div class="col-md-4">
                <a href="{{ url_for('state', run=run) }}"><h2>Detector State</h2></a>
                {% if messages | length == 0 %}
                    <p>No issues!
                {% else %}
                    <ul>
                    {% for message in messages %}
                        <li>{{ message }}
                    {% endfor %}
                    </ul>
                {% endif %}
            </div>
            <div class="col-md-4">
                <h2>Channel Settings</h2>
                {% if channels | length == 0 %}
                    <p>No issues!
                {% else %}
                    <ul>
                    {% for crate, card, channel, message in channels %}
                        <li><a href="{{ '%s?crate=%i&slot=%i&channel=%i' % (url_for('channel_status'),crate,card,channel) }}">{{ "%i/%i/%i" % (crate,card,channel) }}</a> - {{ "%s" % (message) }}
                    {% endfor %}
                    </ul>
                {% endif %}
            </div>
            <div class="col-md-4">
                <h2>Active Alarms</h2>
                {% if alarms | length == 0 %}
                    <p>No alarms!
                {% else %}
                <ul>
                    {% for alarm in alarms %}
                        <li>{{ alarm['description'] }}
                    {% endfor %}
                </ul>
                {% endif %}
            </div>
        </div>
        <div class="row">
            <div class="col-md-4">
                <h2>DAQ Log Warnings</h2>
                {% if warnings | length == 0 %}
                    <p>No warnings!
                {% else %}
                    {% for line in warnings %}
                        <p>{{ line }}
                    {% endfor %}
                {% endif %}
            </div>
        </div>
    </div>
{% endblock %}
