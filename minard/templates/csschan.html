{% extends "layout.html" %}
{% block title %}CSS{% endblock %}
{% block head %}
    <!-- metrics-graphics stylesheet goes above super() because we want bootstrap's style
    (which is linked in super()) to override it. -->
    <link rel="stylesheet" type="text/css"  href="{{ url_for('static',filename='css/metricsgraphics.css') }}">
    <link rel="stylesheet" type="text/css"  href="{{ url_for('static',filename='css/mg_line_brushing.css') }}">
    {{ super() }}
{% endblock %}
{% block body %}
    {{ super() }}

    <div class="container">
        <div class="row">
            <div class="col-md-10 col-md-offset-1">
                <center>
                    <ul class="pager">
                        <li class="previous"><a href="{{ url_for('cssChannel', chan= results.chan-1 ) }}">Prev</a></li>
                        <li><h2 style="display:inline"> Channel {{ results.chan }} </h2></li>
                        <li class="next"><a href="{{ url_for('cssChannel', chan= results.chan+1 ) }}">Next</a></li>
                    </ul>
                    <h4> {{ results.chan }} </h4>
                    <h4> {{ results.chan }} </h4>
                </center>
            </div>
        </div>
    </div>

    <div class="container">
	{% if error %}
	<div class="alert alert-danger" role="alert">
	<span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
	Error: {{ error }}
	</div>
	{% else %}
	<div class="row">
	    <div class="col-md-12" id='highOcc'></div>
        </div>
	<div class="row">
	    <div class="col-md-12" id='highOcc_1'></div>
        </div>
	<div class="row">
            {# <div class="col-md-12" id="myDiv"></div> #}
            <div class = "col-md-12">
                <div id="myDiv"></div>
            </div>
        </div>
	{% endif %}
    </div>
{% endblock %}
{% block script %}
    <script src="{{ url_for('static', filename='js/d3.js') }}"></script>
    <script src="{{ url_for('static', filename='js/metricsgraphics.js') }}"></script>
    <script src="{{ url_for('static', filename='js/mg_line_brushing.js') }}"></script>
    <script src="{{ url_for('static', filename='plotly/plotly-latest.min.js') }}"></script>

    <script>

        var runs= {{  results.runs | tojson }};
        var highOcc = {{  results.highOcc | tojson }};
        var highOccError= {{  results.highOcc_Error | tojson }};

        if( runs.length != highOcc.length){
            console.log("array lengths are different");
        }

        var dataFrame= new Array();
        for (var i=0; i <runs.length; i++) {
            dataFrame.push({'runs': runs[i],
                            'highOcc': highOcc[i],
                            'highOccError': highOccError[i]
                            {# 'highOccError': highOccError[i] #}
            });
        }

        

        MG.data_graphic({
            title: "High Occupancy",
            description: "High Occupancy on channel",
            data: dataFrame,
            chart_type: 'point',
            width: $('#highOcc').width(),
            height: 250,
            left: 100,
            target: '#highOcc',
            x_accessor: 'runs',
            y_accessor: 'highOcc',
            x_label: 'run',
            y_label: 'highOcc'
            {# ,x_rug: true #}
        });

        MG.data_graphic({
            title: "High Occupancy",
            description: "High Occupancy on channel",
            data: dataFrame,
            {# least_squares: true, #}
            chart_type: 'point',
            width: 0.90*$('#highOcc_1').width(),
            height:200,
            left: 100,
            target: '#highOcc_1',
            x_accessor: 'runs',
            y_accessor: 'highOcc',
            x_label: 'run',
            y_label: 'High Occ'
        });

        var data = [
            {
                x: [0, 1, 2],
                y: [6, 10, 2],
                error_y: {
                    type: 'data',
                    array: [1, 2, 3],
                    visible: true
                },
                type: 'scatter'
            }
        ];
        Plotly.newPlot('myDiv', data);

    </script>
{% endblock %}
