#!/usr/bin/env python
from minard.dispatch import dispatch_worker

if __name__ == '__main__':
    import argparse
    from multiprocessing import Process
    import time

    parser = argparse.ArgumentParser(description='Process SNO+ events from a dispatch stream')
    parser.add_argument('--host',default='builder1.sp.snolab.ca',
                        help='hostname of the dispatcher')
    args = parser.parse_args()

    while True:
        try:
            dispatch_worker(args.host)
        except Exception as e:
            sys.stderr.write(str(e) + '\n')

        time.sleep(10)
